---
title: Diffuse Photonを考慮した3次元輻射輸送計算on GPUs（Part 1）
lang: ja
authors:
  - name: 田中 賢
    affil: 筑波大学計算科学研究センター
  - name: 吉川 耕司
    affil: 筑波大学計算科学研究センター
  - name: 岡本 崇
    affil: 北海道大学
  - name: 長谷川 賢二
    affil: 名古屋大学
img_thumb: tanaka_art_diffuse-thumb.jpg
img:
  - tanaka_art_diffuse.jpg
  - tanaka_art_diffuse-2.jpg

categories:
  - featured
  - ja
---

<!-- fig.1 : 中心星の近くに遮蔽物を置いた際の電離度の時間発展の様子。
  上：中心星からの光と再結合光子の輸送を考慮した計算。下：中心星からの光のみの計算。-->

<!--fig.2 : CPUのみとGPUを用いた際の計算時間の比較。
  GPUを使用した計算時間はおおよそ10倍高速化されている。-->

<h3>内容</h3>
<p>
星間空間，銀河形成や進化，宇宙の大規模構造などでの物理現象を正確に記述するには，星や星間媒質から
放射される光の影響を計算する輻射輸送方程式を厳密に解く必要がある。
星からの光は中性ガスに吸収され減衰していくだけであるが，紫外線以上のエネルギーを受け取った中性ガスは電離し，
電離ガスである確率で電子と再結合をして中性ガスに戻り，その際に再結合光子という電離光子を放射するので
新たな光源になり周囲に影響を及ぼすため無視することはできない。
我々の研究ではこの電離光子の影響を調べるために新たな輻射輸送計算コードを開発し，更にGPU（Graphics Processing Unit）
へ実装することにより非常に時間のかかる計算を高速に解けるようにした。
</p>

<h3>手法</h3>
<p>
光の軌道を計算し正確に輻射輸送計算を計算できる手法にray-tracing法というものがあるが，
計算量が流体や重力計算に比べて膨大なため3次元計算では，電離ガスからの再結合光子放射は無視し，
星からの放射のみを考慮した"on-the-spot"近似というものがよく用いられていた。
これは電離ガスからの再結合光子が同じ場所の中性ガスにすぐに吸収され電離ガスになるため放射は
なかったとみなす近似であるが，中性ガス密度が高い光学的厚みが大きい場合以外には基本的には
成り立たない近似である。
しかしながら，今までの研究では光学的厚みが薄いような不適切な場合でもこの近似が使われている問題があったので，
我々の研究ではray-tracing法の一種であるART（Authentic Radiative Transfer）
法を用いて星間媒質からの再結合光子の輸送を考慮した計算を可能とした。
また，星からの放射はARGOT（Accelerated Radiative Transfer on Grids using Oct-Tree）法
を用いることにより，大幅に計算時間を短縮しつつ正確に計算することが可能となっている。
</p>

<h3>結果</h3>
<p>

図１は中心星の近くに高密度のclumpを置いた際の電離度の時間発展の様子である。
上図は中心星と星間媒質の放射を考慮したもので，下図は中心星の放射のみの結果である。
再結合光子の輸送を考慮することにより，遮蔽物の裏側へ電離光子が回りこみ，電離領域が成長すること
が確認できる。また，遮蔽物がない方向でも中心星付近の領域から再結合光子によって周囲の電離度
が若干上がり，中心星からの放射も再結合光子がない場合に比べて透過しやすくなっている。
この電離度の変化が熱，化学発展にも影響を与えるため状況によっては再結合光子が重要になりうる。
</p>

<h3>高速化</h3>
<p>
再結合光子の輸送を計算する際に，計算時間がボトルネックとなり大規模な計算への応用が困難であったが，
我々の開発した手法では近年のスーパーコンピュータで主流となっているマルチコアCPUや
GPUを効率的に利用できるように実装しており，大規模な計算も可能とした。
筑波大学計算科学研究センターの計算機 HA-PACS のGPUクラスタを用いることにより，CPUのみの計算機に
10倍の高速化に成功している（図２）。
</p>

<h3>今後の発展</h3>
<p>
この計算手法を応用し，宇宙の再電離期における星間媒質からの放射の効果や銀河内に
おける光子の脱出確率の推定，ダストによる光の吸収や赤外線放射が及ぼす影響などを鮮明に解明
することへ期待できる。
</p>

<a href="http://pasj.oxfordjournals.org/content/67/4/62">本論文は</a>，日本天文学会の欧文研究報告に掲載された。

